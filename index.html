<!DOCTYPE html>
<html lang="vi" class="notranslate" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Master - Full 250 Questions & Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f0c29; --primary: #00d2ff; --secondary: #928dab;
            --accent: #3a7bd5; --neon-purple: #bc13fe; --glass: rgba(255, 255, 255, 0.05);
            --danger: #ff4757; --success: #2ed573;
        }
        * { box-sizing: border-box; user-select: none; }
        body {
            margin: 0; font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white; height: 100vh; overflow: hidden;
            display: flex; justify-content: center; align-items: center;
        }
        .container {
            width: 95%; max-width: 900px; background: var(--glass);
            backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px; padding: 25px; box-shadow: 0 0 30px rgba(0, 210, 255, 0.2);
            position: relative; text-align: center;
        }
        .screen { display: none; animation: fadeIn 0.4s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* HUD & Game UI */
        .hud { display: flex; justify-content: space-between; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; margin-bottom: 20px; font-family: 'Orbitron'; border-bottom: 2px solid var(--primary); }
        .question-box { background: rgba(0,0,0,0.4); padding: 20px; border-radius: 15px; margin-bottom: 20px; font-size: 1.2rem; min-height: 100px; display: flex; align-items: center; justify-content: center; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .option-card { background: rgba(255,255,255,0.05); border: 1px solid var(--secondary); padding: 15px; border-radius: 10px; cursor: pointer; transition: 0.2s; font-size: 1rem; }
        .option-card:hover { background: rgba(0, 210, 255, 0.2); border-color: var(--primary); transform: translateY(-3px); }

        /* Admin Dashboard */
        .admin-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .stat-card { background: rgba(0,0,0,0.4); padding: 10px; border-radius: 10px; border-left: 3px solid var(--primary); }
        .stat-card h4 { margin: 0; font-size: 0.7rem; color: var(--secondary); }
        .stat-card p { margin: 5px 0 0; font-family: 'Orbitron'; font-size: 1rem; color: var(--primary); }
        .log-container { max-height: 250px; overflow-y: auto; background: rgba(0,0,0,0.5); border-radius: 10px; margin-top: 10px; }
        .monitor-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
        .monitor-table th { background: #1a1a2e; padding: 10px; position: sticky; top: 0; }
        .monitor-table td { padding: 8px; border-bottom: 1px solid #222; }

        /* AI Bot */
        #ai-bot { position: fixed; bottom: 20px; right: 20px; width: 280px; background: rgba(15, 12, 41, 0.95); border: 2px solid var(--primary); border-radius: 15px; padding: 15px; z-index: 1000; box-shadow: 0 0 20px var(--primary); display: none; }
        
        .btn { background: linear-gradient(90deg, var(--accent), var(--neon-purple)); border: none; padding: 12px 25px; color: white; font-family: 'Orbitron'; cursor: pointer; border-radius: 50px; transition: 0.3s; margin: 5px; }
        input { background: rgba(0,0,0,0.5); border: 1px solid var(--primary); color: white; padding: 12px; border-radius: 10px; width: 80%; margin: 10px 0; outline: none; }
    </style>
</head>
<body>

    <div id="ai-bot">
        <div style="font-family:'Orbitron'; font-size:0.7rem; color:var(--primary); border-bottom:1px solid #333; margin-bottom:10px;">ü§ñ CYBER-AI ASSISTANT</div>
        <div id="ai-content">H·ªá th·ªëng ƒë√£ s·∫µn s√†ng.</div>
    </div>

    <div class="container">
        <div id="login-screen" class="screen active">
            <h1>English Master</h1>
            <p>Mission: Conquer 250 Grammar Challenges</p>
            <input type="text" id="username" placeholder="Nh·∫≠p H·ªç v√† T√™n">
            <input type="text" id="userclass" placeholder="Nh·∫≠p L·ªõp">
            <br>
            <button class="btn" onclick="userLogin()">START MISSION</button>
            <button class="btn" style="background: #333;" onclick="switchScreen('admin-auth-screen')">ADMIN</button>
        </div>

        <div id="game-screen" class="screen">
            <div class="hud">
                <div style="color:var(--danger)">‚è∞ <span id="time-display">25:00</span></div>
                <div id="q-count">Q: 1/20</div>
                <div style="color:var(--primary)">‚≠ê <span id="score-display">0</span></div>
            </div>
            <div class="question-box" id="question-text">ƒêang t·∫£i c√¢u h·ªèi...</div>
            <div id="options-area" class="options-grid"></div>
            <div id="feedback" style="margin-top:20px; font-weight:bold; height:20px;"></div>
        </div>

        <div id="admin-auth-screen" class="screen">
            <h2>X√°c th·ª±c Admin</h2>
            <input type="password" id="admin-pass" placeholder="M·∫≠t kh·∫©u Qu·∫£n tr·ªã">
            <br>
            <button class="btn" onclick="accessAdmin()">V√ÄO DASHBOARD</button>
            <button class="btn" style="background:#444" onclick="switchScreen('login-screen')">QUAY L·∫†I</button>
        </div>

        <div id="admin-dashboard-screen" class="screen">
            <h2>ADMIN DASHBOARD</h2>
            <div class="admin-stats">
                <div class="stat-card"><h4>T·ªîNG USER</h4><p id="st-users">0</p></div>
                <div class="stat-card"><h4>ƒêI·ªÇM TB</h4><p id="st-avg">0</p></div>
                <div class="stat-card"><h4>T·ª∂ L·ªÜ ƒê√öNG</h4><p id="st-acc">0%</p></div>
            </div>
            <div class="log-container">
                <table class="monitor-table" id="log-table">
                    <thead><tr><th>User</th><th>H√†nh ƒë·ªông</th><th>Th·ªùi gian</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            <button class="btn btn-danger" style="background:var(--danger)" onclick="resetLogs()">X√ìA D·ªÆ LI·ªÜU</button>
            <button class="btn" onclick="location.reload()">ƒêƒÇNG XU·∫§T</button>
        </div>

        <div id="result-screen" class="screen">
            <h2>Nhi·ªám v·ª• Ho√†n t·∫•t!</h2>
            <h1 id="final-score" style="font-size: 4rem; color:var(--primary)">0</h1>
            <p>B·∫°n ƒë√£ v∆∞·ª£t qua th·ª≠ th√°ch h√¥m nay.</p>
            <button class="btn" onclick="location.reload()">QUAY L·∫†I TRANG CH·ª¶</button>
        </div>
    </div>

    <script>
        // --- 250 C√ÇU H·ªéI ---
        const masterBank = [
            // (Ph·∫ßn n√†y t√¥i ƒë√£ l·∫≠p tr√¨nh s·∫µn ƒë·ªÉ b·∫°n c√≥ th·ªÉ th√™m h√†ng lo·∫°t)
            {q: "She _______ her homework at the moment.", o: ["is doing", "does", "did", "has done"], a: "is doing"},
            {q: "We _______ this film three times already.", o: ["saw", "see", "have seen", "are seeing"], a: "have seen"},
            {q: "If I _______ you, I would study harder.", o: ["am", "was", "were", "be"], a: "were"},
            {q: "The classroom _______ every day.", o: ["cleans", "is cleaned", "cleaned", "is cleaning"], a: "is cleaned"},
            {q: "He usually _______ to school by bike.", o: ["go", "goes", "went", "is going"], a: "goes"},
            {q: "I _______ him since last year.", o: ["don't see", "didn't see", "haven't seen", "won't see"], a: "haven't seen"},
            {q: "Look! The bus _______.", o: ["comes", "is coming", "has come", "came"], a: "is coming"},
            {q: "She wishes she _______ a new car.", o: ["has", "had", "will have", "is having"], a: "had"},
            {q: "English _______ all over the world.", o: ["speaks", "is spoken", "is speaking", "spoke"], a: "is spoken"},
            {q: "They _______ in this house for ten years.", o: ["live", "lived", "have lived", "are living"], a: "have lived"}
        ];
        
        // Th√™m c√°c c√¢u h·ªèi m·∫´u ƒë·ªÉ test (B·∫°n h√£y paste 250 c√¢u v√†o m·∫£ng masterBank n√†y)
        for(let i=1; i<=240; i++) {
            masterBank.push({
                q: `[C√¢u h·ªèi s·ªë ${i+10}] Ch·ªçn ƒë√°p √°n ƒë√∫ng cho c·∫•u tr√∫c ng·ªØ ph√°p b√†i ${Math.ceil(i/10)}:`,
                o: ["ƒê√°p √°n A", "ƒê√°p √°n B", "ƒê√°p √°n C", "ƒê√°p √°n D"],
                a: "ƒê√°p √°n A"
            });
        }

        let logs = JSON.parse(localStorage.getItem('cyberLogs')) || [];
        let currentUser = {name: "", class: ""};
        let score = 0; let qIndex = 0; let gameQuestions = [];
        let timer; let timeLeft = 1500;

        // --- ADMIN LOGIC ---
        function accessAdmin() {
            if(document.getElementById('admin-pass').value === "123456") {
                switchScreen('admin-dashboard-screen');
                renderAdmin();
            } else alert("Sai m·∫≠t kh·∫©u!");
        }

        function renderAdmin() {
            const tbody = document.querySelector('#log-table tbody');
            tbody.innerHTML = logs.slice().reverse().map(l => `<tr><td>${l.u}</td><td style="color:${l.act.includes('ƒê√∫ng')?'#2ed573':'#ff4757'}">${l.act}</td><td>${l.t}</td></tr>`).join('');
            
            const users = new Set(logs.map(l => l.u)).size;
            document.getElementById('st-users').innerText = users;
            const correct = logs.filter(l => l.act.includes('ƒê√∫ng')).length;
            const total = logs.filter(l => l.act.includes('ƒê√∫ng') || l.act.includes('Sai')).length;
            document.getElementById('st-acc').innerText = total > 0 ? Math.round(correct/total*100) + "%" : "0%";
            document.getElementById('st-avg').innerText = (correct*10 / (users || 1)).toFixed(1);
        }

        function addLog(act) {
            logs.push({u: currentUser.name, act: act, t: new Date().toLocaleTimeString()});
            localStorage.setItem('cyberLogs', JSON.stringify(logs));
        }

        function resetLogs() { if(confirm("X√≥a h·∫øt?")) { localStorage.removeItem('cyberLogs'); logs = []; renderAdmin(); }}

        // --- GAME LOGIC ---
        function switchScreen(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); }

        function userLogin() {
            const n = document.getElementById('username').value;
            const c = document.getElementById('userclass').value;
            if(n && c) {
                currentUser = {name: n, class: c};
                addLog("B·∫Øt ƒë·∫ßu l√†m b√†i");
                aiSpeak(`Ch√†o ${n}, h·ªá th·ªëng ƒë√£ b·ªëc ng·∫´u nhi√™n 20 c√¢u h·ªèi cho b·∫°n!`);
                startGame();
            } else alert("Nh·∫≠p ƒë·ªß t√™n v√† l·ªõp!");
        }

        function startGame() {
            switchScreen('game-screen');
            gameQuestions = masterBank.sort(() => 0.5 - Math.random()).slice(0, 20);
            loadQ();
            timer = setInterval(() => {
                timeLeft--;
                let m = Math.floor(timeLeft/60); let s = timeLeft%60;
                document.getElementById('time-display').innerText = `${m}:${s<10?'0'+s:s}`;
                if(timeLeft <= 0) endGame();
            }, 1000);
        }

        function loadQ() {
            const q = gameQuestions[qIndex];
            document.getElementById('q-count').innerText = `Q: ${qIndex+1}/20`;
            document.getElementById('question-text').innerText = q.q;
            const area = document.getElementById('options-area');
            area.innerHTML = "";
            q.o.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-card';
                btn.innerText = opt;
                btn.onclick = () => checkAns(opt, q.a);
                area.appendChild(btn);
            });
        }

        function checkAns(u, a) {
            const fb = document.getElementById('feedback');
            if(u === a) {
                score += 10; fb.innerText = "CH√çNH X√ÅC!"; fb.style.color = "#2ed573";
                addLog(`ƒê√∫ng c√¢u ${qIndex+1}`);
                aiSpeak("R·∫•t t·ªët, ti·∫øp t·ª•c n√†o!");
            } else {
                fb.innerText = "SAI R·ªíI!"; fb.style.color = "#ff4757";
                addLog(`Sai c√¢u ${qIndex+1}`);
                aiSpeak("ƒê·ª´ng lo, h√£y c·∫©n th·∫≠n h∆°n.");
            }
            setTimeout(() => {
                fb.innerText = "";
                qIndex++;
                if(qIndex < 20) loadQ(); else endGame();
            }, 1000);
        }

        function endGame() {
            clearInterval(timer);
            switchScreen('result-screen');
            document.getElementById('final-score').innerText = score;
            addLog(`K·∫øt th√∫c - ƒêi·ªÉm: ${score}`);
        }

        function aiSpeak(txt) {
            document.getElementById('ai-bot').style.display = 'block';
            document.getElementById('ai-content').innerText = txt;
        }
    </script>
</body>
</html>
