<!DOCTYPE html>
<html lang="vi" class="notranslate" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Master - AI Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f0c29; --primary: #00d2ff; --secondary: #928dab;
            --accent: #3a7bd5; --neon-purple: #bc13fe; --glass: rgba(255, 255, 255, 0.05);
        }
        * { box-sizing: border-box; user-select: none; }
        body {
            margin: 0; font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white; height: 100vh; overflow: hidden;
            display: flex; justify-content: center; align-items: center;
        }
        .container {
            width: 90%; max-width: 900px; background: var(--glass);
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px; padding: 30px; box-shadow: 0 0 20px rgba(188, 19, 254, 0.3);
            position: relative; text-align: center; z-index: 5;
        }
        .screen { display: none; animation: fadeIn 0.5s ease; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        h1, h2, h3 { font-family: 'Orbitron', sans-serif; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 10px var(--primary); }
        .btn {
            background: linear-gradient(90deg, var(--accent), var(--neon-purple));
            border: none; padding: 12px 30px; color: white; font-family: 'Orbitron';
            cursor: pointer; border-radius: 50px; transition: 0.3s; margin: 10px;
        }
        .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--neon-purple); }
        input { background: rgba(0,0,0,0.5); border: 1px solid var(--primary); color: white; padding: 12px; border-radius: 10px; width: 80%; margin: 10px 0; outline: none; }
        
        /* AI Bot Styles */
        #ai-bot {
            position: fixed; bottom: 20px; right: 20px; width: 300px;
            background: rgba(15, 12, 41, 0.95); border: 2px solid var(--primary);
            border-radius: 15px; padding: 15px; z-index: 1000; box-shadow: 0 0 20px var(--primary);
            display: none; transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .bot-header { font-family: 'Orbitron'; font-size: 0.8rem; color: var(--primary); border-bottom: 1px solid #333; margin-bottom: 10px; display: flex; justify-content: space-between; }
        #ai-content { font-size: 0.95rem; line-height: 1.4; color: #fff; text-shadow: 0 0 5px rgba(0,210,255,0.5); }
        
        /* HUD & Game */
        .hud { display: flex; justify-content: space-between; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; margin-bottom: 20px; font-family: 'Orbitron'; border-bottom: 2px solid var(--primary); }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .option-card { background: rgba(255,255,255,0.05); border: 1px solid var(--secondary); padding: 15px; border-radius: 10px; cursor: pointer; transition: 0.2s; }
        .option-card:hover { background: rgba(0, 210, 255, 0.2); border-color: var(--primary); }
        .monitor-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; margin-top: 10px; }
        .monitor-table th, td { padding: 8px; border: 1px solid rgba(255,255,255,0.1); }
    </style>
</head>
<body>

    <div id="ai-bot">
        <div class="bot-header"><span>ü§ñ CYBER-AI ASSISTANT</span><span id="bot-status">‚óè Online</span></div>
        <div id="ai-content">ƒêang kh·ªüi ƒë·ªông h·ªá th·ªëng nh·∫≠n di·ªán...</div>
    </div>

    <div class="container">
        <div id="login-screen" class="screen active">
            <h1>English Master</h1>
            <p>AI-Powered English Learning Mission</p>
            <input type="text" id="username" placeholder="Nh·∫≠p H·ªç v√† T√™n">
            <input type="text" id="userclass" placeholder="Nh·∫≠p L·ªõp">
            <br>
            <button class="btn" onclick="checkLogin()">B·∫ÆT ƒê·∫¶U NHI·ªÜM V·ª§</button>
            <button class="btn" style="background: #444" onclick="switchScreen('admin-login-screen')">ADMIN</button>
        </div>

        <div id="game-screen" class="screen">
            <div class="hud">
                <div style="color:#ff4757">‚è∞ <span id="time-display">25:00</span></div>
                <div id="score-display">‚≠ê 0</div>
                <div style="color:#ffa502">üíé <span id="gem-display">0</span></div>
            </div>
            <h3 id="question-type" style="color:var(--secondary); font-size: 0.8rem;">TYPE</h3>
            <div id="question-text" style="background:rgba(0,0,0,0.4); padding:20px; border-radius:15px; margin-bottom:20px; font-size:1.2rem;">...</div>
            <div id="interaction-area"></div>
            <div id="feedback-msg" style="margin-top:15px; font-weight:bold; height:20px;"></div>
        </div>

        <div id="admin-login-screen" class="screen">
            <h2>X√°c th·ª±c Qu·∫£n tr·ªã</h2>
            <input type="password" id="admin-pass" placeholder="M·∫≠t kh·∫©u Admin">
            <button class="btn" onclick="validateAdmin()">TRUY C·∫¨P</button>
            <button class="btn" onclick="switchScreen('login-screen')">H·ª¶Y</button>
        </div>

        <div id="admin-panel" class="screen">
            <h2>Gi√°m s√°t H·ªá th·ªëng</h2>
            <div style="max-height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 10px;">
                <table class="monitor-table" id="monitor-table">
                    <thead><tr><th>User</th><th>Class</th><th>Action</th><th>Time</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            <button class="btn" onclick="clearLogs()">X√ìA NH·∫¨T K√ù</button>
            <button class="btn" onclick="switchScreen('login-screen')">THO√ÅT</button>
        </div>

        <div id="result-screen" class="screen">
            <h2>Nhi·ªám v·ª• Ho√†n t·∫•t!</h2>
            <p>T·ªïng ƒëi·ªÉm: <span id="final-score">0</span></p>
            <button class="btn" onclick="location.reload()">L√ÄM L·∫†I</button>
        </div>
    </div>

    <script>
        // 1. NG√ÇN H√ÄNG C√ÇU H·ªéI (250 c√¢u) - R√∫t g·ªçn v√≠ d·ª•, b·∫°n copy paste th√™m t·ª´ danh s√°ch c≈© c·ªßa b·∫°n
        const questionBank = [
            { type: 'mcq', q: "She _______ her homework at the moment.", options: ["is doing", "does", "did", "has done"], a: "is doing" },
            { type: 'mcq', q: "We _______ this film three times already.", options: ["saw", "see", "have seen", "are seeing"], a: "have seen" },
            // ... TH√äM ƒê·ª¶ 250 C√ÇU C·ª¶A B·∫†N V√ÄO ƒê√ÇY ...
        ];

        // 2. BI·∫æN TO√ÄN C·ª§C
        let currentUser = { name: "", class: "" };
        let score = 0; let gems = 0;
        let currentQuestions = []; let qIndex = 0;
        let timer; let timeLeft = 1500;
        let userLogs = JSON.parse(localStorage.getItem('cyberLogs')) || [];

        // 3. AI LOGIC (T∆∞∆°ng t√°c m·∫°nh h∆°n)
        function aiSpeak(type, customText = "") {
            const bot = document.getElementById('ai-bot');
            const content = document.getElementById('ai-content');
            bot.style.display = 'block';
            
            let message = "";
            const name = currentUser.name;

            switch(type) {
                case 'welcome': message = `Ch√†o ${name}! T√¥i ƒë√£ n·∫°p d·ªØ li·ªáu b√†i t·∫≠p cho l·ªõp ${currentUser.class}. S·∫µn s√†ng ch∆∞a?`; break;
                case 'correct': 
                    const praise = ["Tuy·ªát ƒë·ªânh!", "Qu√° chu·∫©n!", "ƒê√∫ng r·ªìi ƒë√≥!"];
                    message = `${praise[Math.floor(Math.random()*praise.length)]} B·∫°n ƒë√£ ƒë·∫°t ${score} ƒëi·ªÉm.`;
                    break;
                case 'wrong': message = `Ti·∫øc qu√° ${name} ∆°i. H√£y xem l·∫°i c·∫•u tr√∫c n√†y nh√©. ƒê·ª´ng b·ªè cu·ªôc!`; break;
                case 'streak': message = `WOW! ${name} ƒëang c√≥ chu·ªói tr·∫£ l·ªùi ƒë√∫ng r·∫•t ·∫•n t∆∞·ª£ng!`; break;
                case 'hint': message = customText; break;
                case 'finish': message = `Ch√∫c m·ª´ng ${name}! B·∫°n ƒë√£ ho√†n th√†nh xu·∫•t s·∫Øc nhi·ªám v·ª• h√¥m nay.`; break;
            }
            content.innerText = message;
            
            // Hi·ªáu ·ª©ng nh√°y ƒë√®n AI
            document.getElementById('bot-status').style.color = '#2ed573';
            setTimeout(() => { document.getElementById('bot-status').style.color = '#00d2ff'; }, 1000);
        }

        // 4. H·ªÜ TH·ªêNG QU·∫¢N TR·ªä & THEO D√ïI
        function logAction(act) {
            userLogs.push({ user: currentUser.name, class: currentUser.class, action: act, time: new Date().toLocaleTimeString() });
            localStorage.setItem('cyberLogs', JSON.stringify(userLogs));
        }

        function validateAdmin() {
            if (document.getElementById('admin-pass').value === "123456") {
                switchScreen('admin-panel');
                const tbody = document.querySelector('#monitor-table tbody');
                tbody.innerHTML = userLogs.map(l => `<tr><td>${l.user}</td><td>${l.class}</td><td>${l.action}</td><td>${l.time}</td></tr>`).reverse().join('');
            } else { alert("Sai m·∫≠t kh·∫©u!"); }
        }

        // 5. GAME LOGIC
        function switchScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function checkLogin() {
            const n = document.getElementById('username').value;
            const c = document.getElementById('userclass').value;
            if (n && c) {
                currentUser = { name: n, class: c };
                logAction("ƒêƒÉng nh·∫≠p");
                aiSpeak('welcome');
                setTimeout(startGame, 1500);
            } else { alert("Nh·∫≠p t√™n v√† l·ªõp!"); }
        }

        function startGame() {
            switchScreen('game-screen');
            currentQuestions = questionBank.sort(() => 0.5 - Math.random()).slice(0, 20);
            loadQuestion();
            startTimer();
        }

        function startTimer() {
            timer = setInterval(() => {
                timeLeft--;
                let m = Math.floor(timeLeft/60); let s = timeLeft%60;
                document.getElementById('time-display').innerText = `${m}:${s<10?'0'+s:s}`;
                if(timeLeft <= 0) endGame();
            }, 1000);
        }

        function loadQuestion() {
            const q = currentQuestions[qIndex];
            document.getElementById('question-type').innerText = `C√ÇU ${qIndex+1}/20 - ${q.type.toUpperCase()}`;
            document.getElementById('question-text').innerText = q.q;
            const area = document.getElementById('interaction-area');
            area.innerHTML = "";
            
            if(q.type === 'mcq') {
                const grid = document.createElement('div');
                grid.className = 'options-grid';
                q.options.forEach(opt => {
                    const btn = document.createElement('div');
                    btn.className = 'option-card';
                    btn.innerText = opt;
                    btn.onclick = () => checkAnswer(opt, q.a);
                    grid.appendChild(btn);
                });
                area.appendChild(grid);
            }
        }

        function checkAnswer(user, correct) {
            const feedback = document.getElementById('feedback-msg');
            if (user === correct) {
                score += 10; feedback.innerText = "CH√çNH X√ÅC!"; feedback.style.color = "#2ed573";
                aiSpeak('correct');
                logAction(`ƒê√∫ng c√¢u ${qIndex+1}`);
            } else {
                feedback.innerText = "SAI R·ªíI!"; feedback.style.color = "#ff4757";
                aiSpeak('wrong');
                logAction(`Sai c√¢u ${qIndex+1}`);
            }
            
            setTimeout(() => {
                qIndex++;
                if(qIndex < currentQuestions.length) loadQuestion();
                else endGame();
            }, 1500);
        }

        function endGame() {
            clearInterval(timer);
            switchScreen('result-screen');
            document.getElementById('final-score').innerText = score;
            aiSpeak('finish');
            logAction(`Ho√†n th√†nh v·ªõi ${score} ƒëi·ªÉm`);
        }

        function clearLogs() { localStorage.removeItem('cyberLogs'); location.reload(); }
    </script>
</body>
</html>
